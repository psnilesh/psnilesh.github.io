---
title: OAuth2 Auth workflow
tags:
- Programming
layout: post
excerpt_separator: "<!--more-->"
---

OAuth2 is the industry standard for granting third-praty applications limited acccess to your data on another service (like Google).  <!--more-->. Check out [this amazing blog post](https://commandline.ninja/saml-oauth-oidc/) that explains the differences between SAML, OAuth and OpenID. 


Below sequence diagram shows high level interactions involved when using oauth to grant a 3rd party application limited access to your Google profile, 


![Sequence diagram]({{ "assets/images/oauth2.png" | relative_url }})

<details>

	<summary> View source </summary>
	<pre>
@startuml
autonumber
skinparam shadowing false

actor User
participant "App (Client)" as App
participant "Google Auth Server" as Google
participant "Resource Server" as API

User -> App: Click "Login with Google"
App -> Google: Redirect to Authorization URL\n(client_id, scope, redirect_uri)
Google -> User: Prompt for Credentials & Consent
User -> Google: Authenticate & Authorize
Google -> App: Redirect to redirect_uri\n(Authorization Code)
App -> Google: POST /token\n(code, client_id, client_secret)
Google -> App: Return Access Token & ID Token
App -> API: Request User Info\n(Authorization: Bearer token)
API -> App: User Profile Data
App -> User: Authenticated Session Established
@enduml
	</pre>
</details>